<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="994px" preserveAspectRatio="none" style="width:909px;height:994px;" version="1.1" viewBox="0 0 909 994" width="909px" zoomAndPan="magnify"><defs><filter height="300%" id="f12awaow5twf07" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="45" x2="45" y1="54.5938" y2="982.3125"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="158" x2="158" y1="54.5938" y2="982.3125"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="292" x2="292" y1="54.5938" y2="982.3125"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="405" x2="405" y1="54.5938" y2="982.3125"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="516.5" x2="516.5" y1="54.5938" y2="982.3125"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="687" x2="687" y1="54.5938" y2="982.3125"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="832" x2="832" y1="54.5938" y2="982.3125"/><rect fill="#FFFFE0" filter="url(#f12awaow5twf07)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="70" x="8" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="15" y="39.292">Browser</text><rect fill="#FFFFE0" filter="url(#f12awaow5twf07)" height="46.5938" style="stroke: #808080; stroke-width: 1.5;" width="128" x="92" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="134.5" y="22.9951">AuthN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="99" y="39.292">Identity Provider</text><rect fill="#FFFFE0" filter="url(#f12awaow5twf07)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="113" x="234" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="241" y="39.292">Reverse Proxy</text><rect fill="#90EE90" filter="url(#f12awaow5twf07)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="84" x="361" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="368" y="39.292">Plug-Front</text><rect fill="#90EE90" filter="url(#f12awaow5twf07)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="81" x="474.5" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="481.5" y="39.292">Plug-Back</text><rect fill="#FFFFE0" filter="url(#f12awaow5twf07)" height="46.5938" style="stroke: #808080; stroke-width: 1.5;" width="128" x="621" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="663.5" y="22.9951">AuthZ</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="628" y="39.292">Identity Provider</text><rect fill="#FFFFE0" filter="url(#f12awaow5twf07)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="135" x="763" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="770" y="39.292">Web Applications</text><polygon fill="#2F4F4F" points="280.5,81.7266,290.5,85.7266,280.5,89.7266,284.5,85.7266" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="45" x2="286.5" y1="85.7266" y2="85.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="52" y="80.6606">GET /app</text><polygon fill="#2F4F4F" points="393,110.8594,403,114.8594,393,118.8594,397,114.8594" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="292.5" x2="399" y1="114.8594" y2="114.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="299.5" y="109.7935">/validate/app</text><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="159.125" y2="159.125"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="159.125" y2="172.125"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="172.125" y2="172.125"/><polygon fill="#2F4F4F" points="416,168.125,406,172.125,416,176.125,412,172.125" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="412" y="138.9263">Authenticated?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="17" x="412" y="154.0591">No</text><polygon fill="#2F4F4F" points="303.5,197.2578,293.5,201.2578,303.5,205.2578,299.5,201.2578" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="297.5" x2="404" y1="201.2578" y2="201.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="309.5" y="196.1919">HTTP 401</text><polygon fill="#2F4F4F" points="393,226.3906,403,230.3906,393,234.3906,397,230.3906" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="292.5" x2="399" y1="230.3906" y2="230.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="299.5" y="225.3247">GET /login</text><polygon fill="#2F4F4F" points="56,255.5234,46,259.5234,56,263.5234,52,259.5234" style="stroke: #2F4F4F; stroke-width: 1.0;"/><polygon fill="#2F4F4F" points="393,255.5234,403,259.5234,393,263.5234,397,259.5234" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="399" y1="259.5234" y2="259.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="62" y="254.4575">Pre-Login selection</text><polygon fill="#2F4F4F" points="56,284.6563,46,288.6563,56,292.6563,52,288.6563" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="404" y1="288.6563" y2="288.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="62" y="283.5903">HTTP 301 login callback url</text><polygon fill="#2F4F4F" points="146,313.7891,156,317.7891,146,321.7891,150,317.7891" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="45" x2="152" y1="317.7891" y2="317.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="52" y="312.7231">Login</text><polygon fill="#2F4F4F" points="56,342.9219,46,346.9219,56,350.9219,52,346.9219" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="157" y1="346.9219" y2="346.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="19" x="62" y="341.856">OK</text><polygon fill="#2F4F4F" points="393,372.0547,403,376.0547,393,380.0547,397,376.0547" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="45" x2="399" y1="376.0547" y2="376.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="52" y="370.9888">HTTP 301 Oauth2 callback endpoint</text><polygon fill="#2F4F4F" points="169,401.1875,159,405.1875,169,409.1875,165,405.1875" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="163" x2="404" y1="405.1875" y2="405.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="175" y="400.1216">GET /userinfo</text><polygon fill="#2F4F4F" points="393,415.1875,403,419.1875,393,423.1875,397,419.1875" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="158" x2="399" y1="419.1875" y2="419.1875"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="463.4531" y2="463.4531"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="463.4531" y2="476.4531"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="476.4531" y2="476.4531"/><polygon fill="#2F4F4F" points="416,472.4531,406,476.4531,416,480.4531,412,476.4531" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="412" y="443.2544">Authenticated?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="412" y="458.3872">Yes</text><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="520.7188" y2="520.7188"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="520.7188" y2="533.7188"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="533.7188" y2="533.7188"/><polygon fill="#2F4F4F" points="416,529.7188,406,533.7188,416,537.7188,412,533.7188" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="412" y="500.52">Authorized?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="17" x="412" y="515.6528">No</text><polygon fill="#2F4F4F" points="505,543.7188,515,547.7188,505,551.7188,509,547.7188" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="511" y1="547.7188" y2="547.7188"/><polygon fill="#2F4F4F" points="675,587.9844,685,591.9844,675,595.9844,679,591.9844" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="517" x2="681" y1="591.9844" y2="591.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="524" y="571.7856">e.g. isMemberOfGroup</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="524" y="586.9185">Employees</text><polygon fill="#2F4F4F" points="528,601.9844,518,605.9844,528,609.9844,524,605.9844" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="522" x2="686" y1="605.9844" y2="605.9844"/><polygon fill="#2F4F4F" points="416,615.9844,406,619.9844,416,623.9844,412,619.9844" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="410" x2="516" y1="619.9844" y2="619.9844"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="664.25" y2="664.25"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="664.25" y2="677.25"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="677.25" y2="677.25"/><polygon fill="#2F4F4F" points="416,673.25,406,677.25,416,681.25,412,677.25" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="412" y="644.0513">Authorized?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="412" y="659.1841">Yes</text><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="721.5156" y2="721.5156"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="721.5156" y2="734.5156"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="734.5156" y2="734.5156"/><polygon fill="#2F4F4F" points="416,730.5156,406,734.5156,416,738.5156,412,734.5156" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="412" y="701.3169">Use 2FA?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="412" y="716.4497">Yes</text><polygon fill="#2F4F4F" points="505,759.6484,515,763.6484,505,767.6484,509,763.6484" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="511" y1="763.6484" y2="763.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="412" y="758.5825">Get 2FA</text><polygon fill="#2F4F4F" points="416,773.6484,406,777.6484,416,781.6484,412,777.6484" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="410" x2="516" y1="777.6484" y2="777.6484"/><polygon fill="#2F4F4F" points="56,787.6484,46,791.6484,56,795.6484,52,791.6484" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="404" y1="791.6484" y2="791.6484"/><polygon fill="#2F4F4F" points="393,816.7813,403,820.7813,393,824.7813,397,820.7813" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="45" x2="399" y1="820.7813" y2="820.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="52" y="815.7153">One Time Password</text><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="865.0469" y2="865.0469"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="865.0469" y2="878.0469"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="878.0469" y2="878.0469"/><polygon fill="#2F4F4F" points="416,874.0469,406,878.0469,416,882.0469,412,878.0469" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="412" y="844.8481">2FA OK?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="412" y="859.981">Yes</text><polygon fill="#2F4F4F" points="303.5,903.1797,293.5,907.1797,303.5,911.1797,299.5,907.1797" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="297.5" x2="404" y1="907.1797" y2="907.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="309.5" y="902.1138">HTTP 200</text><polygon fill="#2F4F4F" points="820.5,917.1797,830.5,921.1797,820.5,925.1797,824.5,921.1797" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="292.5" x2="826.5" y1="921.1797" y2="921.1797"/><polygon fill="#2F4F4F" points="303.5,931.1797,293.5,935.1797,303.5,939.1797,299.5,935.1797" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="297.5" x2="831.5" y1="935.1797" y2="935.1797"/><polygon fill="#2F4F4F" points="56,960.3125,46,964.3125,56,968.3125,52,964.3125" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="291.5" y1="964.3125" y2="964.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="19" x="62" y="959.2466">OK</text><!--MD5=[b88a37a23686d8e733f4eb316955400b]
@startuml
skinparam sequence {
ArrowColor DarkSlateGrey
ParticipantBorderColor Grey
ParticipantBackgroundColor lightyellow
LifeLineBorderColor Grey
}
hide footbox
participant  "Browser" as B
participant "AuthN\nIdentity Provider" as AuthN
participant "Reverse Proxy" as RP
participant "Plug-Front" as PF #lightgreen
participant "Plug-Back" as PB #lightgreen
participant "AuthZ\nIdentity Provider" as AuthZ
participant "Web Applications" as WWW
B -> RP : GET /app
RP -> PF : /validate/app
PF -> PF : Authenticated?\nNo
PF -> RP : HTTP 401
RP -> PF : GET /login
PF <-> B : Pre-Login selection
PF -> B : HTTP 301 login callback url
B -> AuthN : Login
AuthN -> B : OK
B -> PF : HTTP 301 Oauth2 callback endpoint
PF -> AuthN : GET /userinfo
AuthN -> PF
PF -> PF : Authenticated?\nYes
PF -> PF : Authorized?\nNo
PF -> PB
PB -> AuthZ : e.g. isMemberOfGroup\nEmployees
AuthZ -> PB
PB -> PF
PF -> PF : Authorized?\nYes
PF -> PF : Use 2FA?\nYes
PF -> PB : Get 2FA
PB -> PF
PF -> B
B -> PF : One Time Password
PF -> PF : 2FA OK?\nYes
PF -> RP : HTTP 200
RP -> WWW
WWW -> RP
RP -> B : OK
@enduml

PlantUML version 1.2020.08beta10(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 14.0.1+7
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>