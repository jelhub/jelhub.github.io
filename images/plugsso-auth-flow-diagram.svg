<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1051px" preserveAspectRatio="none" style="width:921px;height:1051px;" version="1.1" viewBox="0 0 921 1051" width="921px" zoomAndPan="magnify"><defs><filter height="300%" id="fbhs87qto6o8m" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="45" x2="45" y1="54.5938" y2="1039.5781"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="158" x2="158" y1="54.5938" y2="1039.5781"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="292" x2="292" y1="54.5938" y2="1039.5781"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="405" x2="405" y1="54.5938" y2="1039.5781"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="528.5" x2="528.5" y1="54.5938" y2="1039.5781"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="699" x2="699" y1="54.5938" y2="1039.5781"/><line style="stroke: #808080; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="844" x2="844" y1="54.5938" y2="1039.5781"/><rect fill="#FFFFE0" filter="url(#fbhs87qto6o8m)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="70" x="8" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="15" y="39.292">Browser</text><rect fill="#FFFFE0" filter="url(#fbhs87qto6o8m)" height="46.5938" style="stroke: #808080; stroke-width: 1.5;" width="128" x="92" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="134.5" y="22.9951">AuthN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="99" y="39.292">Identity Provider</text><rect fill="#FFFFE0" filter="url(#fbhs87qto6o8m)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="113" x="234" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="99" x="241" y="39.292">Reverse Proxy</text><rect fill="#90EE90" filter="url(#fbhs87qto6o8m)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="84" x="361" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="70" x="368" y="39.292">Plug-Front</text><rect fill="#90EE90" filter="url(#fbhs87qto6o8m)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="81" x="486.5" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="493.5" y="39.292">Plug-Back</text><rect fill="#FFFFE0" filter="url(#fbhs87qto6o8m)" height="46.5938" style="stroke: #808080; stroke-width: 1.5;" width="128" x="633" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="675.5" y="22.9951">AuthZ</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="640" y="39.292">Identity Provider</text><rect fill="#FFFFE0" filter="url(#fbhs87qto6o8m)" height="30.2969" style="stroke: #808080; stroke-width: 1.5;" width="135" x="775" y="19.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="121" x="782" y="39.292">Web Applications</text><polygon fill="#2F4F4F" points="280.5,81.7266,290.5,85.7266,280.5,89.7266,284.5,85.7266" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="45" x2="286.5" y1="85.7266" y2="85.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="52" y="80.6606">GET /app</text><polygon fill="#2F4F4F" points="393,110.8594,403,114.8594,393,118.8594,397,114.8594" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="292.5" x2="399" y1="114.8594" y2="114.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="299.5" y="109.7935">/validate/app</text><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="159.125" y2="159.125"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="159.125" y2="172.125"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="172.125" y2="172.125"/><polygon fill="#2F4F4F" points="416,168.125,406,172.125,416,176.125,412,172.125" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="412" y="138.9263">/app valid realm?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="412" y="154.0591">Yes</text><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="216.3906" y2="216.3906"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="216.3906" y2="229.3906"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="229.3906" y2="229.3906"/><polygon fill="#2F4F4F" points="416,225.3906,406,229.3906,416,233.3906,412,229.3906" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="412" y="196.1919">Authenticated?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="17" x="412" y="211.3247">No</text><polygon fill="#2F4F4F" points="303.5,254.5234,293.5,258.5234,303.5,262.5234,299.5,258.5234" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="297.5" x2="404" y1="258.5234" y2="258.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="309.5" y="253.4575">HTTP 401</text><polygon fill="#2F4F4F" points="393,283.6563,403,287.6563,393,291.6563,397,287.6563" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="292.5" x2="399" y1="287.6563" y2="287.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="64" x="299.5" y="282.5903">GET /login</text><polygon fill="#2F4F4F" points="56,312.7891,46,316.7891,56,320.7891,52,316.7891" style="stroke: #2F4F4F; stroke-width: 1.0;"/><polygon fill="#2F4F4F" points="393,312.7891,403,316.7891,393,320.7891,397,316.7891" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="399" y1="316.7891" y2="316.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="62" y="311.7231">Pre-Login selection</text><polygon fill="#2F4F4F" points="56,341.9219,46,345.9219,56,349.9219,52,345.9219" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="404" y1="345.9219" y2="345.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="62" y="340.856">HTTP 301 login callback url</text><polygon fill="#2F4F4F" points="146,371.0547,156,375.0547,146,379.0547,150,375.0547" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="45" x2="152" y1="375.0547" y2="375.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="52" y="369.9888">Login</text><polygon fill="#2F4F4F" points="56,400.1875,46,404.1875,56,408.1875,52,404.1875" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="157" y1="404.1875" y2="404.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="19" x="62" y="399.1216">OK</text><polygon fill="#2F4F4F" points="393,429.3203,403,433.3203,393,437.3203,397,433.3203" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="45" x2="399" y1="433.3203" y2="433.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="52" y="428.2544">HTTP 301 Oauth2 callback endpoint</text><polygon fill="#2F4F4F" points="169,458.4531,159,462.4531,169,466.4531,165,462.4531" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="163" x2="404" y1="462.4531" y2="462.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="175" y="457.3872">GET /userinfo</text><polygon fill="#2F4F4F" points="393,472.4531,403,476.4531,393,480.4531,397,476.4531" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="158" x2="399" y1="476.4531" y2="476.4531"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="520.7188" y2="520.7188"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="520.7188" y2="533.7188"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="533.7188" y2="533.7188"/><polygon fill="#2F4F4F" points="416,529.7188,406,533.7188,416,537.7188,412,533.7188" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="412" y="500.52">Authenticated?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="412" y="515.6528">Yes</text><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="577.9844" y2="577.9844"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="577.9844" y2="590.9844"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="590.9844" y2="590.9844"/><polygon fill="#2F4F4F" points="416,586.9844,406,590.9844,416,594.9844,412,590.9844" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="412" y="557.7856">Authorized?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="17" x="412" y="572.9185">No</text><polygon fill="#2F4F4F" points="517,600.9844,527,604.9844,517,608.9844,521,604.9844" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="523" y1="604.9844" y2="604.9844"/><polygon fill="#2F4F4F" points="687,645.25,697,649.25,687,653.25,691,649.25" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="529" x2="693" y1="649.25" y2="649.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="536" y="629.0513">e.g. isMemberOfGroup</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="536" y="644.1841">Employees</text><polygon fill="#2F4F4F" points="540,659.25,530,663.25,540,667.25,536,663.25" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="534" x2="698" y1="663.25" y2="663.25"/><polygon fill="#2F4F4F" points="416,673.25,406,677.25,416,681.25,412,677.25" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="410" x2="528" y1="677.25" y2="677.25"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="721.5156" y2="721.5156"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="721.5156" y2="734.5156"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="734.5156" y2="734.5156"/><polygon fill="#2F4F4F" points="416,730.5156,406,734.5156,416,738.5156,412,734.5156" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="412" y="701.3169">Authorized?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="412" y="716.4497">Yes</text><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="778.7813" y2="778.7813"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="778.7813" y2="791.7813"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="791.7813" y2="791.7813"/><polygon fill="#2F4F4F" points="416,787.7813,406,791.7813,416,795.7813,412,791.7813" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="412" y="758.5825">Use 2FA?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="412" y="773.7153">Yes</text><polygon fill="#2F4F4F" points="517,816.9141,527,820.9141,517,824.9141,521,820.9141" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="523" y1="820.9141" y2="820.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="412" y="815.8481">Get 2FA</text><polygon fill="#2F4F4F" points="416,830.9141,406,834.9141,416,838.9141,412,834.9141" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="410" x2="528" y1="834.9141" y2="834.9141"/><polygon fill="#2F4F4F" points="56,844.9141,46,848.9141,56,852.9141,52,848.9141" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="404" y1="848.9141" y2="848.9141"/><polygon fill="#2F4F4F" points="393,874.0469,403,878.0469,393,882.0469,397,878.0469" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="45" x2="399" y1="878.0469" y2="878.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="52" y="872.981">One Time Password</text><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="405" x2="447" y1="922.3125" y2="922.3125"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="447" x2="447" y1="922.3125" y2="935.3125"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="406" x2="447" y1="935.3125" y2="935.3125"/><polygon fill="#2F4F4F" points="416,931.3125,406,935.3125,416,939.3125,412,935.3125" style="stroke: #2F4F4F; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="412" y="902.1138">2FA OK?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="412" y="917.2466">Yes</text><polygon fill="#2F4F4F" points="303.5,960.4453,293.5,964.4453,303.5,968.4453,299.5,964.4453" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="297.5" x2="404" y1="964.4453" y2="964.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="309.5" y="959.3794">HTTP 200</text><polygon fill="#2F4F4F" points="832.5,974.4453,842.5,978.4453,832.5,982.4453,836.5,978.4453" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="292.5" x2="838.5" y1="978.4453" y2="978.4453"/><polygon fill="#2F4F4F" points="303.5,988.4453,293.5,992.4453,303.5,996.4453,299.5,992.4453" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="297.5" x2="843.5" y1="992.4453" y2="992.4453"/><polygon fill="#2F4F4F" points="56,1017.5781,46,1021.5781,56,1025.5781,52,1021.5781" style="stroke: #2F4F4F; stroke-width: 1.0;"/><line style="stroke: #2F4F4F; stroke-width: 1.0;" x1="50" x2="291.5" y1="1021.5781" y2="1021.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="19" x="62" y="1016.5122">OK</text><!--MD5=[bb830a3dcf40e43633a98f857c3f8621]
@startuml
skinparam sequence {
ArrowColor DarkSlateGrey
ParticipantBorderColor Grey
ParticipantBackgroundColor lightyellow
LifeLineBorderColor Grey
}
hide footbox
participant  "Browser" as B
participant "AuthN\nIdentity Provider" as AuthN
participant "Reverse Proxy" as RP
participant "Plug-Front" as PF #lightgreen
participant "Plug-Back" as PB #lightgreen
participant "AuthZ\nIdentity Provider" as AuthZ
participant "Web Applications" as WWW
B -> RP : GET /app
RP -> PF : /validate/app
PF -> PF : /app valid realm?\nYes 
PF -> PF : Authenticated?\nNo
PF -> RP : HTTP 401
RP -> PF : GET /login
PF <-> B : Pre-Login selection
PF -> B : HTTP 301 login callback url
B -> AuthN : Login
AuthN -> B : OK
B -> PF : HTTP 301 Oauth2 callback endpoint
PF -> AuthN : GET /userinfo
AuthN -> PF
PF -> PF : Authenticated?\nYes
PF -> PF : Authorized?\nNo
PF -> PB
PB -> AuthZ : e.g. isMemberOfGroup\nEmployees
AuthZ -> PB
PB -> PF
PF -> PF : Authorized?\nYes
PF -> PF : Use 2FA?\nYes
PF -> PB : Get 2FA
PB -> PF
PF -> B
B -> PF : One Time Password
PF -> PF : 2FA OK?\nYes
PF -> RP : HTTP 200
RP -> WWW
WWW -> RP
RP -> B : OK
@enduml

PlantUML version 1.2020.08beta10(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 14.0.1+7
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>